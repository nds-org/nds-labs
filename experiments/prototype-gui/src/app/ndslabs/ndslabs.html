<section class="container-fluid">
  <!-- Selector(s) Pane -->
  <div class="row">
    <div class="col-md-3">      
      <h4>Services</h4>
      <div>
        <div id="stackSearchHeader">
          <div class="input-group">
            <span class="input-group-addon" id="basic-addon1"><i class="fa fa-search"></i></span>
            <input type="text" class="form-control" placeholder="Search..." ng-model="svcQuery" aria-describedby="basic-addon1" />
          </div>
          
          <span class="label label-danger" ng-show="(services | filter : svcQuery).length === 0">No services match the query</span>
        </div>
        
        <table class="table table-striped table-condensed table-hover" ng-hide="(services | filter : svcQuery).length === 0">
          <thead>
            <tr>
              <td width="95%"><strong>NDS Labs Service</strong></td>
              <td width="5%"><strong>Add</strong></td>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="stack in stacks | orderBy:'key'| filter : svcQuery">
              <td>{{ stack.label }}</td>
              <td>
                <button class="btn btn-xs btn-primary" ng-click="addStack(stack)">
                  <i class="fa fa-plus"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
   
    <!-- Configured Stacks --> 
    <div class="col-md-9">
      <div>
        <h4>Configured Stacks</h4>
        <table class="table table-striped table-condensed table-hover">
          <thead>
            <tr>
              <td width="10%"><strong>Status</strong></td>
              <td width="35%"><strong>Name</strong></td>
              <td width="50%"><strong>Services</strong></td>
              <td width="7%"><strong>Edit</strong></td>
              <td width="8%"><strong>Remove</strong></td>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="stack in configuredStacks" ng-mouseleave="service.showHover = false;" ng-mouseenter="service.showHover = true;">
              <td class="text-center">
                 <toggle-switch ng-model="stack.status"><toggle-switch>
              </td>
              <td>{{ stack.name }}</td>
              <td>
                <ul>
                  <li ng-repeat="svc in stack.services">{{ svc.serviceId }}</li>
                </ul>
              </td>
              <td class="text-center">
                <button class="btn btn-xs btn-danger" ng-click="editStack(stack)">
                  <i class="fa fa-pencil"></i>
                </button>
              </td>
              <td class="text-center">
                <button class="btn btn-xs btn-danger" ng-click="removeStack(stack)">
                  <i class="fa fa-times"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
  </div>

  <div>
      <!-- Wizard Popup (Modal) -->
      <div class="modal fade" id="wizardModal" tabindex="-1" role="dialog" aria-labelledby="wizardModalLabel">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title" id="wizardModalLabel">{{ newStack.label }} Configuration Wizard</h4>
            </div>
            <div class="modal-body">
              <div class="row">
                    <!-- Wizard Page selector --> 
                    <div class="col-md-12">                        
                        <!-- Wizard progress bar here -->
                        <div class="progress">
                          <div class="progress-bar" ng-class="{ 'progress-bar-success': wizard.percentage == 100}" role="progressbar" aria-valuenow="{{ wizard.percentage }}" aria-valuemin="0" aria-valuemax="100" style="min-width: 2em; width: {{ wizard.percentage }}%;">
                            {{ wizard.percentage | number:0 }}%
                          </div>
                        </div>

                        <h4>{{ wizard.currentPage.displayName }}</h4>
                        
                        <!-- Wizard Pages shown here -->
                        <div ng-if="wizard.currentPage.key === 'intro'">
                          <p>It looks like you are trying to add a new instance of {{ newStackLabel }}.</p>
                          <p>Please choose a <strong>name</strong> for this stack: <input class="form-control" type="text" ng-model="newStack.name" /></p>
                          <p>This wizard will now guide you through the steps of choosing any required / optional plugins or configuration customizations.</p>
                        </div>

                        <!-- Configuration Page -->
                        <div ng-if="wizard.currentPage.key === 'config'">
                          <p>Stack services:</p>
                          <ul class="list-group">
                            <li ng-repeat="req in newStack.services" class="list-group-item disabled">
                              {{ req.serviceId }}<input class="pull-right" type="checkbox" checked="true" />
                            </li>
                          </ul>
                          
                          <p ng-show="newStackOptions.length > 0">Please choose the optional service plugins that you wish to enable below:</p>
                          <ul class="list-group" ng-class="{ 'active':optionalLinksGrid.selector.selection.indexOf(opt) !== -1 }">
                            <li ng-class="{ 'active':optionalLinksGrid.selector.selection.indexOf(opt) !== -1 }" ng-click="optionalLinksGrid.selector.select.toggle(opt)" ng-repeat="opt in newStackOptions" class="list-group-item">
                              <p>{{ opt.serviceId }}<input class="pull-right" type="checkbox" ng-checked="optionalLinksGrid.selector.selection.indexOf(opt) !== -1" /></p>
                              <p ng-if="optionalDeps=_.find(deps, function(dep) { return dep.key === opt.serviceId }).dependencies.length > 0">Requires:
                                <ul>
                                  <li ng-repeat="dep in optionalDeps">{{ dep.label }}</li>
                                </ul>
                              </p>
                            </li>
                          </ul>
                        </div>

                        <!-- Volumes Page -->
                        <div ng-if="wizard.currentPage.key === 'volumes'">
                          <p>It looks like you are adding {{ newService.persisted ? 'some' : 'no' }} services that require a volume.</p>
                        </div>

                        <!-- Ask the user for confirmation -->
                        <div ng-if="wizard.currentPage.key === 'confirm'">
                          <p>You have chosen to enable {{ optionalLinksGrid.selector.selection.length || "no" }} optional service plugins<span ng-show="newService.links.required">, along with the {{ newService.links.required.length }} required services</span>.</p>
                          <p>Services that will be added to the <i>"{{ newStack.name }}"</i> stack:</p>
                          <ul class="list-group">
                            <li class="list-group-item disabled" ng-repeat="req in newStack.services">{{ req.serviceId }}</li>
                          </ul>

                          <p>Click <strong>Next</strong> to add these all of these services to your namespace.</p>
                        </div>

                        <!-- Final Page -->
                        <div ng-if="wizard.currentPage.key === 'finish'">
                          <p>You have successfully configured {{ newStack.name }}.</p>
                          <p>You should now see the instance listed on the right-hand side of the page.</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
              <div ng-if="wizard.currentPage.key !== 'finish'">
                <!-- "Cancel" button (close modal with success === false) -->
                <button class="btn btn-danger pull-left" ng-if="wizard.currentPage.key !== 'finish'" data-dismiss="modal" aria-label="Close"><i class="fa fa-times"></i>&nbsp;&nbsp;Cancel</button>

                <!-- Previous Page -->
                <button class="btn btn-primary" ng-disabled="!wizard.canPrevPage()" ng-click="wizard.prevPage()"><i class="fa fa-arrow-circle-left"></i>&nbsp;&nbsp;Back</button>

                <!-- Next Page -->
                <button class="btn btn-primary" ng-disabled="!wizard.canNextPage()" ng-click="wizard.nextPage()">
                  Next&nbsp;&nbsp;<i class="fa fa-arrow-circle-right"></i>
                </button>
              </div>

              <!-- "Finish" button (close modal with success === true) -->
              <div ng-if="wizard.currentPage.key === 'finish'">
                <button class="btn btn-success" ng-disabled="!wizard.canPrevPage()" data-dismiss="modal" aria-label="Close" ng-click="finishWizard(newStack)">Finish&nbsp;&nbsp;<i class="fa fa-check-circle"></i></button>
              </div>
            </div>
          </div>
        </div>
      </div>
</div>
</section>
